---
apiVersion: deviceregistry.microsoft.com/v1
kind: Asset
metadata:
  name: {{ .Values.asset.name | default "device-001" }}
  namespace: {{ .Values.namespace | default "azure-iot-operations" }}
spec:
  displayName: {{ .Values.asset.displayName | default "Device 001" }}
  description: {{ .Values.asset.description }}
  # assetEndpointProfileRef is of form <namespace>/<asset name>
  assetEndpointProfileRef: '{{ .Values.namespace | default "azure-iot-operations" }}/{{ .Values.asset.name | default "device-001" }}'
  defaultDatasetsConfiguration: |-
    {
       "samplingInterval": {{ .Values.asset.defaultDatasetsSamplingInterval | default 2000 }},
    }
  defaultTopic:
    path: '{{ .Values.namespace | default "azure-iot-operations" }}/data/{{ .Values.asset.name | default "device-001" }}'
    retain: Keep
  datasets:
    - name: thermodynamics
      datasetConfiguration: |-
        {
           "samplingInterval": 5000,
        }
      dataPoints:
        - dataSource: /piwebapi/assetservers/F1RSCf1onAl8tkuTYgE2NfIPFQQVZFVkFQSQ/assetdatabases
          name: currentAmbientTemperature
          dataPointConfiguration: |-
            {
               "HttpRequestMethod": "GET",
            }
    - name: pneumatics
      datasetConfiguration: |-
        {
           "samplingInterval": 1000,
        }
      dataPoints:
        - dataSource: /piwebapi/assetdatabases/F1RDCf1onAl8tkuTYgE2NfIPFQNp0AsaE7302XMsysUw2j2gQVZFVkFQSVxERUZBVUxUVVNFUkRC/elements
          name: currentAmbientTemperature
          dataPointConfiguration: |-
            {
               "HttpRequestMethod": "GET",
            }
